<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/front}">
<head><title layout:fragment="title" th:text="(${page.name} + ' | ' + ${siteName})"></title></head>
<body class="bg-dark-secondary">
<main layout:fragment="content">
    <div th:each="compEntry : ${page.components}">
        <div th:with="comp=${compEntry.value}">
            <!-- Hero -->
            <div th:if="${comp.type == 'hero' && comp.status == 'enable'}">
                <section id="top" class="relative">
                    <div class="min-h-screen flex flex-col justify-center items-center pt-20 relative z-10">
                        <div class="absolute inset-0">
                            <img th:src="@{/images/hero-primary.jpg}"
                                 alt="Hero Background"
                                 class="w-full h-full object-cover opacity-60">
                            <div class="absolute inset-0 bg-black opacity-85"></div>
                        </div>
                        <div class="text-center max-w-7xl px-6 animate-on-scroll">
                            <h1 class="text-6xl md:text-8xl text-white font-bold mb-6 leading-tight"><span th:text="${comp.title}">default-content</span></h1>
                            <p class="text-2xl md:text-3xl text-text-gray mb-8 font-light"><span th:text="${comp.subtitle}">default-content</span></p>
                            <p class="text-lg text-text-gray max-w-2xl mx-auto mb-12 leading-relaxed"><span th:text="${comp.description}">default-content</span></p>

                            <a th:each="button : ${comp.buttons}" th:href="${button.value.url}" th:if="${button.value.style == 1 && comp.button == true}" class="bg-gradient-to-r from-accent-orange to-accent-yellow text-dark mx-2 px-8 py-4 rounded-lg font-semibold text-lg hover:scale-105 transition-all duration-300 animate-glow">
                                <span th:text="${button.value.text}">default-content</span>
                            </a>
                            <a th:each="button : ${comp.buttons}" th:href="${button.value.url}" th:if="${button.value.style == 2 && comp.button == true}" class="border-2 border-accent-orange text-accent-orange px-8 py-4 mx-2 rounded-lg font-semibold text-lg hover:bg-accent-orange hover:text-dark transition-all duration-300">
                                <span th:text="${button.value.text}">default-content</span>
                            </a>
                            <br><br><br><br>
                            <br><br><br><br>
                        </div>
                    </div>
                    <svg class="absolute bottom-0 left-0 w-full mt-10    z-10" style="pointer-events: none; bottom: -2px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                        <path fill="#111827" fill-opacity="1" d="M0,192L60,202.7C120,213,240,235,360,245.3C480,256,600,256,720,234.7C840,213,960,171,1080,170.7C1200,171,1320,213,1380,234.7L1440,256L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z"></path>
                    </svg>
                </section>
            </div>
            <!-- Video -->
            <div th:if="${comp.type == 'video' && comp.status == 'enable'}">
                <section id="showreel" class="py-24 bg-dark-secondary">
                    <div class="max-w-7xl mx-auto px-6">
                        <div class="text-center mb-16 animate-on-scroll">
                            <h2 class="text-5xl font-bold text-white mb-4"><span th:text="${comp.title}">default-content</span></h2>
                            <p class="text-xl text-text-gray max-w-2xl mx-auto"><span th:text="${comp.subtitle}">default-content</span></p>
                        </div>
                        <div class="max-w-4xl mx-auto animate-on-scroll">
                            <div class="video-card" x-data="videoPlayer()">
                                <div class="relative">
                                    <video
                                            x-ref="video"
                                            @click="togglePlay"
                                            class="w-full rounded-lg"
                                            th:poster="${comp.video_poster}"
                                    >
                                        <source th:src="${comp.video_url}" type="video/mp4">
                                    </video>
                                    <div
                                            class="play-button relative z-10"
                                            :class="{'opacity-0 pointer-events-none': isPlaying, 'opacity-100 pointer-events-auto': !isPlaying}"
                                            @click.stop="play"
                                    >
                                        <div class="play-icon"></div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </section>
            </div>
            <!-- Cards type 1 -->
            <div th:if="${comp.type == 'row_cards_1' && comp.status == 'enable'}">
                <section id="service" class="py-24 bg-dark-secondary">
                    <div class="max-w-6xl mx-auto px-6">
                        <div class="text-center mb-16 animate-on-scroll">
                            <h2 class="text-5xl text-white font-bold mb-4"><span th:text="${comp.title}">default-content</span></h2>
                            <p class="text-xl text-text-gray max-w-2xl mx-auto"><span th:text="${comp.subtitle}">default-content</span></p>
                        </div>

                        <div class="grid md:grid-cols-3 gap-8">
                            <div th:each="cardEntry : ${comp.cards}" class="bg-dark-secondary rounded-2xl p-8 text-center hover:bg-dark-card transition-all duration-300 animate-on-scroll">
                                <div class="w-16 h-16 bg-gradient-to-r from-accent-orange to-accent-yellow rounded-xl flex items-center justify-center text-2xl mx-auto mb-6">
                                    <span th:text="${cardEntry.value.icon}">default-content</span>
                                </div>
                                <h3 class="text-xl text-white font-semibold mb-4"><span th:text="${cardEntry.value.title}">default-content</span></h3>
                                <p class="text-text-gray leading-relaxed"><span th:text="${cardEntry.value.description}">default-content</span></p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <!-- Cards type 2 -->
            <div th:if="${comp.type == 'row_cards_2' && comp.status == 'enable'}">
                <section id="contact" class="py-24 bg-dark-secondary">
                    <div class="max-w-4xl mx-auto px-6 text-center">
                        <div class="animate-on-scroll">
                            <h2 class="text-5xl text-white font-bold mb-6"><span th:text="${comp.title}">default-content</span></h2>
                            <p class="text-xl text-text-gray mb-12 max-w-2xl mx-auto"><span th:text="${comp.title}">default-content</span></p>
                            <div class="grid md:grid-cols-3 gap-8 mb-12">
                                <div th:each="cardEntry : ${comp.cards}" class="bg-dark-card rounded-xl p-6">
                                    <div class="w-12 h-12 bg-gradient-to-r from-accent-orange to-accent-yellow rounded-xl flex items-center justify-center text-xl mx-auto mb-4">
                                        <span th:text="${cardEntry.value.icon}">default-content</span>
                                    </div>
                                    <h3 class="font-semibold text-white  mb-2"><span th:text="${cardEntry.value.title}">default-content</span></h3>
                                    <a class="text-accent-orange hover:underline"><span th:text="${cardEntry.value.description}">default-content</span></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <!-- Row videos -->
            <div th:if="${comp.type == 'row_video' && comp.status == 'enable'}">
                <section id="projects" class="py-24">
                    <div class="max-w-7xl mx-auto text-center px-6">
                        <h2 class="text-5xl font-bold mb-6 text-gradient"><span th:text="${comp.title}">default-content</span></h2>
                        <p class="text-xl text-text-gray mb-12 max-w-2xl mx-auto"><span th:text="${comp.subtitle}">default-content</span></p>
                        <div class="reel-grid">
                            <div th:each="videoCard : ${comp.videos}" class="video-card" x-data="videoPlayer()">
                                <div class="relative">
                                    <video
                                            x-ref="video"
                                            @click="togglePlay"
                                            class="w-full rounded-lg"
                                            th:poster="${videoCard.value.poster}"
                                    >
                                        <source th:src="${videoCard.value.url}" type="video/mp4">
                                    </video>
                                    <div
                                            class="play-button relative z-10"
                                            :class="{'opacity-0 pointer-events-none': isPlaying, 'opacity-100 pointer-events-auto': !isPlaying}"
                                            @click.stop="play"
                                    >
                                        <div class="play-icon"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <!-- Row posts -->
            <div th:if="${comp.type == 'row_posts' && comp.status == 'enable'}">
                <section id="posts" class="py-24">
                    <div class="max-w-7xl mx-auto px-6">
                        <h2 class="text-5xl font-bold text-center mb-6 text-gradient"><span th:text="${comp.title}">default-content</span></h2>
                        <p class="text-xl text-text-gray text-center mb-12 max-w-2xl mx-auto"><span th:text="${comp.subtitle}">default-content</span></p>
                        <div class="reel-grid">
                            <a th:each="post : ${allPosts}" th:href="${'/posts/' + post.slug}" class="group rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-2 overflow-hidden cursor-pointer" style="background-color: var(--color-dark-card);">
                                <div class="aspect-video relative overflow-hidden" style="background: linear-gradient(135deg, var(--color-accent-orange), var(--color-accent-yellow));">
                                    <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-colors duration-300"></div>
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <svg class="w-12 h-12 text-white/80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                                        </svg>
                                    </div>
                                </div>
                                <div class="p-6">
                                    <div class="flex items-center gap-2 mb-3">
                                        <!--
                                        <span class="px-3 py-1 text-xs font-medium rounded-full" style="background-color: var(--color-accent-orange); color: white;">
                                            Technology
                                        </span>
                                        -->
                                    </div>
                                    <h3 class="text-xl font-bold text-white mb-3 group-hover:transition-colors duration-300" style="group-hover:color: var(--color-accent-yellow);" th:text="${post.title}">
                                        default-content
                                    </h3>
                                    <!--
                                    <p class="text-sm leading-relaxed mb-4" style="color: var(--color-text-gray);">
                                        Learn how to create robust, scalable APIs using GraphQL and Node.js, with practical examples and best practices.
                                    </p>
                                    -->
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-2">
                                            <div class="w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-semibold" style="background: linear-gradient(135deg, var(--color-accent-orange), var(--color-accent-yellow));">
                                                U
                                            </div>
                                            <span class="text-white text-sm font-medium">User</span>
                                        </div>
                                        <span class="text-sm" style="color: var(--color-text-gray);">
                                            <time th:text="${post.createdAt}"></time>
                                        </span>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </section>
            </div>
            <!-- Row projects modal -->
            <div th:if="${comp.type == 'card_modal' and comp.status == 'enable'}">
                <section id="projects_modal" class="py-24">
                    <div class="max-w-7xl mx-auto text-center px-6">
                        <h2 class="text-5xl font-bold mb-6 text-gradient" th:text="${comp.title}">Mes Projets</h2>
                        <p class="text-xl text-text-gray mb-12 max-w-2xl mx-auto" th:text="${comp.subtitle}">Des clips musicaux aux courts-métrages, découvrez ma diversité créative</p>

                        <!-- GRID DE CARDS -->
                        <div class="reel-grid">
                            <div th:each="entry, iterStat : ${comp.cards}" class="video-card" x-data="videoPlayer()">
                                <a href="#" class="relative block rounded-xl overflow-hidden shadow-lg"
                                   th:attr="data-modal-target='modal-' + ${iterStat.index}"
                                   th:attrappend="data-modal-toggle='modal-' + ${iterStat.index}">
                                    <img class="w-full h-auto" th:src="${entry.value.poster}" alt="poster">
                                    <div class="absolute inset-0 bg-black/25 opacity-0 hover:opacity-100 transition"></div>
                                </a>
                            </div>
                        </div>

                        <!-- MODALS -->
                        <div th:each="entry, iterStat : ${comp.cards}" th:id="'modal-' + ${iterStat.index}" tabindex="-1" aria-hidden="true" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 animated">
                            <div class="relative bg-white rounded-lg shadow-lg w-full max-w-5xl max-h-full overflow-auto dark:bg-dark-card">
                                <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600 border-gray-200">
                                    <h3 class="text-xl font-semibold text-gray-900 dark:text-white" th:text="${entry.value.title}"></h3>
                                    <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white"  th:attr="data-modal-hide='modal-' + ${iterStat.index}">
                                        <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                                        </svg>
                                        <span class="sr-only">Close modal</span>
                                    </button>
                                </div>
                                <!-- VIDEO -->
                                <div class="p-4">
                                    <!-- Vidéo locale -->
                                    <video id="player-file" th:if="${entry.value.modal.video.type == 'file'}" controls class="w-full rounded-lg">
                                        <source th:src="@{${entry.value.modal.video.url}}" type="video/mp4">
                                    </video>
                                    <!-- Vidéo YouTube -->
                                    <div th:if="${entry.value.modal.video.type == 'youtube'}" class="relative w-full">
                                        <div id="player-youtube"
                                             th:if="${entry.value.modal.video.type == 'youtube'}"
                                             data-plyr-provider="youtube"
                                             th:attr="data-plyr-embed-id=${entry.value.modal.video.url}"
                                             class="w-full rounded-lg"></div>

                                    </div>
                                </div>
                                <!-- DESCRIPTION -->
                                <div class="p-4 pt-0 pb-10 text-left text-white">
                                    <p th:text="${entry.value.modal.description}">Description par défaut</p>
                                </div>
                            </div>
                        </div>

                    </div>
                </section>
            </div>
        </div>
        <style>
            /* Conteneur Plyr full-width */
            .plyr__video-embed {
                position: relative;
                width: 100%;           /* prend toute la largeur */
                padding-top: 56.25%;   /* ratio 16:9 (hauteur/largeur = 9/16) */
            }

            /* iframe à l'intérieur du conteneur */
            .plyr__video-embed iframe {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
            }
        </style>
    </div>
</main>
</body>
</html>
